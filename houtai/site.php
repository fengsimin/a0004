<?php
//Copyright (c) 2016 iFeiwu.com
 class Site extends Item { function __construct() { $this->table = "\x73\151\164\x65"; parent::__construct(); } protected function getData() { goto rsFwl; rsFwl: $data = $this->db->select($this->table)->all(); goto jOs25; stxWv: foreach ($data as $d) { goto GmMra; Ndjft: if (!($value != '')) { goto XlPZn; } goto PXyx0; PXyx0: $site[$d["\x6e\141\x6d\x65"]] = $value; goto RSVGr; zl77Y: dFlOb: goto DuoTn; RSVGr: XlPZn: goto zl77Y; GmMra: $value = $d["\x76\141\154\x75\145"]; goto Ndjft; DuoTn: } goto uPgQo; uPgQo: w_oqg: goto FOOjp; jOs25: $site = array(); goto stxWv; FOOjp: return $this->success($site); goto ohOTJ; ohOTJ: } protected function postSave($request_data) { goto Xa0w_; fXcyf: goto u1J2y; goto tScMB; an3Ox: t1mJs: goto UQu1T; S7Ixw: $this->_log("\165\x70\144\x61\x74\145", array("\164\x69\x74\x6c\x65" => "\xe7\xbd\x91\xe7\253\231\350\256\276\347\xbd\256")); goto cV9cV; UQu1T: if (count($error) === 0) { goto eroU1; } goto m6YFR; Xa0w_: $this->_removeFiles2($request_data["\137\x72\145\x6d\157\166\145\x66\x69\154\x65\163"]); goto i3dD5; cV9cV: return $this->success("\345\267\262\xe4\xbf\235\xe5\xad\230\346\x9b\xb4\346\224\xb9\357\xbc\201"); goto IPrB_; A1x_L: foreach ($request_data as $name => $value) { goto XDD3_; GZJWK: L4xZs: goto DAZq1; xsfV3: if ($count <= 0) { goto THxAp; } goto Bmc99; pRhTV: gBcDA: goto XCioJ; XDD3_: $count = $this->db->select($this->table)->where(array("\156\x61\155\145", "\x3d", $name))->count(); goto nUUNJ; Oa5DC: goto ZPb5c; goto wFPjh; wIRNy: $error[] = $name; goto eze3m; XCioJ: ZPb5c: goto GZJWK; wFPjh: THxAp: goto PMk8l; PMk8l: if (!($this->db->insert($this->table, array("\156\141\155\x65" => $name, "\166\x61\154\x75\x65" => $value))->is() === false)) { goto gBcDA; } goto gDuAm; nUUNJ: $value = $this->_encode($value); goto xsfV3; eze3m: bza1R: goto Oa5DC; Bmc99: if (!($this->db->update($this->table, array("\x76\x61\x6c\x75\145" => $value), array("\x6e\141\x6d\x65", "\75", $name))->is() === false)) { goto bza1R; } goto wIRNy; gDuAm: $error[] = $name; goto pRhTV; DAZq1: } goto an3Ox; m6YFR: $this->db->rollBack(); goto aHHih; x1aa9: $this->db->commit(); goto S7Ixw; aHHih: return $this->error("\xe5\xb7\xb2\344\277\x9d\345\255\x98\345\xa4\xb1\350\xb4\xa5\357\xbc\x81"); goto fXcyf; F0aW_: $this->db->beginTransaction(); goto A1x_L; i3dD5: unset($request_data["\x74\x6f\x6b\x65\156"], $request_data["\141\144\x6d\x69\156"], $request_data["\x5f\x72\x65\155\157\166\145\x66\x69\x6c\x65\x73"]); goto iSjem; iSjem: $error = array(); goto F0aW_; tScMB: eroU1: goto x1aa9; IPrB_: u1J2y: goto I8U86; I8U86: } protected function postSkin($request_data) { goto tcEY_; y_ZZK: if (!isset($request_data["\x74\x68\x65\155\x65\55\x73\x6b\151\x6e"])) { goto d8z9T; } goto WIKD0; WIKD0: $skins = explode("\x2d", $request_data["\164\150\145\155\145\55\x73\153\151\x6e"]); goto GvjRf; OiS7j: foreach ($request_data as $name => $value) { $this->_saveData($this->table, array("\x6e\x61\x6d\145" => $name, "\x76\141\154\165\x65" => $value), array("\x6e\x61\155\145", "\x3d", $name)); eggqV: } goto wo2v4; gRENv: chmod($filename, 420); goto qIimc; GvjRf: $request_data["\164\150\145\155\x65"] = $skins[0]; goto xLZaJ; tcEY_: if (!isset($request_data["\163\164\171\154\x65\55\143\157\144\145"])) { goto MfOJN; } goto d4pX2; qRkN8: d8z9T: goto OiS7j; qIimc: MfOJN: goto eKaiF; wo2v4: l1tWG: goto Fuo4y; Vxgq1: file_put_contents($filename, $request_data["\x73\x74\171\154\145\55\143\x6f\144\x65"]); goto gRENv; Fuo4y: return $this->success("\xe5\xb7\xb2\344\xbf\x9d\xe5\255\x98\xe6\x9b\264\346\x94\271\357\xbc\201"); goto CsiH4; xLZaJ: $request_data["\163\x6b\x69\156"] = $skins[1]; goto qRkN8; eKaiF: unset($request_data["\x74\157\x6b\x65\x6e"], $request_data["\141\144\155\x69\156"], $request_data["\163\x74\x79\154\x65\x2d\143\x6f\x64\x65"]); goto y_ZZK; d4pX2: $filename = "\x2e\56\x2f\141\x73\x73\x65\x74\57\x63\163\163\x2f\x73\x74\171\x6c\x65\x2e\143\x73\x73"; goto Vxgq1; CsiH4: } protected function getStyleCode() { $code = file_get_contents("\x2e\56\x2f\141\x73\163\145\164\57\x63\x73\163\x2f\163\164\x79\154\x65\x2e\x63\x73\163"); return $this->success(array($code)); } }
