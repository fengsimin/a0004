<?php
//Copyright (c) 2016 iFeiwu.com
 class Item extends Ifeiwu { public function __construct() { goto CPnSv; IxAcz: $this->table = "\x69\164\x65\x6d"; goto AuF5Z; aa0tm: parent::__construct(); goto DDPJG; CPnSv: if ($this->table) { goto akFKl; } goto IxAcz; AuF5Z: akFKl: goto aa0tm; DDPJG: } protected function postPage($request_data) { goto MLTYj; ExEeU: $page = $page ? $page - 1 : 0; goto dznET; dznET: $total = $this->db->select($this->table)->where($where)->count(); goto vaiET; MLTYj: $this->_callback("\x63\x61\154\154\x62\x61\143\x6b\120\141\147\145\x42\x65\146\157\x72\x65", array(&$request_data)); goto Xb8df; vaiET: $list = $this->db->select($this->table, $column)->where($where)->order($order)->limit(array($page * $perpage, $perpage))->all(); goto qjqKC; qjqKC: $data = array("\x6c\x69\x73\164" => $list, "\x74\x6f\x74\x61\x6c" => $total, "\x70\145\x72\160\x61\x67\145" => $perpage, "\160\x61\147\145" => $page); goto kVBVe; Xb8df: $column = $request_data["\x63\157\154\165\x6d\156"] ?: "\52"; goto nQ28b; fMfl9: $data = $this->db->select($this->table, $column)->where($where)->order($order)->all(); goto EhMQC; T84Lw: if ($perpage > 0) { goto nO11L; } goto fMfl9; wUsyf: $perpage = $request_data["\160\145\162\x70\x61\x67\x65"] ?: 0; goto T84Lw; EhMQC: goto hZzbT; goto TKZX6; fuYD1: $order = $request_data["\x6f\162\144\x65\x72"] ?: $this->order; goto wUsyf; qe02c: return $this->success($data); goto UGJE4; WM3QU: $this->_callback("\x63\x61\x6c\154\142\141\143\x6b\x50\141\x67\x65\101\146\164\145\x72", array(&$data)); goto qe02c; Y1XnF: $page = $request_data["\160\x61\x67\x65"] ?: 1; goto ExEeU; TKZX6: nO11L: goto Y1XnF; kVBVe: hZzbT: goto WM3QU; nQ28b: $where = $request_data["\167\150\x65\162\145"] ?: "\x31\40\x3d\40\61"; goto fuYD1; UGJE4: } protected function postQuery($request_data) { goto ISe17; GKTG1: PVJYj: goto sNI1p; gvg7M: if (!(stripos($sql, "\x24\x74\x61\142\x6c\145") !== false)) { goto PVJYj; } goto I6oIl; sNI1p: return $this->db->query($sql, $request_data["\x76\141\154\165\x65\163"])->all(); goto PopES; ISe17: $sql = $request_data["\x73\161\x6c"]; goto gvg7M; I6oIl: $sql = str_replace("\44\164\141\142\x6c\145", $this->prefix . $this->table, $sql); goto GKTG1; PopES: } protected function getOne($id, $column = null) { goto spU80; GqVk4: return $this->success($data); goto zp16t; sO4Zp: $data = $this->db->select($this->table, $column)->where(array("\x69\144", "\75", $id))->get(); goto GqVk4; spU80: $column = $column ?: "\52"; goto sO4Zp; zp16t: } protected function postAdd($request_data) { goto sfdZj; D2KYv: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto X4FzG; OItb6: $udata["\x6c\x65\166\x65\x6c"] = $this->_getLevel($pid, $id); goto zrMrh; JJHo7: $pid = $data["\x70\x69\x64"]; goto nOpt3; yhyEy: goto hAEVC; goto qxhsk; XYXZV: AC_al: goto m3Lr3; jVxUL: $id = $this->db->insert($this->table, $data)->id(); goto HBsEe; deZyX: return $this->success("\xe6\xb7\xbb\345\212\240\xe6\225\260\346\x8d\xae\346\210\220\345\x8a\237\xef\274\x81", array("\x69\144" => $id, "\x69\x6d\x61\x67\145\137\160\x61\x74\150" => $upload_path)); goto Smn6y; VS5w8: $this->_log("\141\144\144", array("\164\x69\x74\154\x65" => $data["\x74\x69\x74\x6c\x65"], "\164\141\x62\x6c\145\x5f\x69\x64" => $id)); goto J5wpi; fYn1p: return $this->error("\346\267\273\345\x8a\240\xe6\x95\260\xe6\x8d\xae\345\244\261\350\264\245\xef\274\x81"); goto XYXZV; TYV0D: if ($this->db->update($this->table, $udata, array("\151\x64", "\75", $id))->is()) { goto j_Xck; } goto DzEZ2; cIkf5: $upload_path = $request_data["\x24\165\x70\154\x6f\x61\x64\x5f\x70\x61\x74\x68"]; goto Jg5Th; X4FzG: $udata[$upload_name] = $upload_path; goto YmDwr; qxhsk: j_Xck: goto h8HF4; wKigT: $upload_name = $request_data["\x24\x75\x70\154\157\x61\144\137\156\x61\x6d\145"]; goto cIkf5; G0qT5: $data["\143\164\151\x6d\x65"] = time(); goto UEHe0; YmDwr: mEaAh: goto TYV0D; Lgqza: $data["\x69\x64"] = $id; goto D2KYv; J5wpi: $this->db->commit(); goto deZyX; DzEZ2: $this->db->rollBack(); goto Lux7q; Lux7q: return $this->error("\346\xb7\xbb\xe5\x8a\240\xe6\x95\260\xe6\x8d\256\xe5\244\261\xe8\xb4\xa5\357\274\201"); goto yhyEy; UEHe0: $this->db->beginTransaction(); goto jVxUL; sfdZj: $this->_callback("\x63\x61\154\x6c\x62\141\143\x6b\101\x64\144\x42\145\x66\x6f\162\x65", array(&$request_data)); goto ANVZZ; Jg5Th: if (!($upload_name && $upload_path)) { goto mEaAh; } goto Lgqza; ANVZZ: $this->_removeFiles2($request_data["\x5f\162\x65\155\x6f\166\145\146\x69\154\145\x73"]); goto bivX1; HBsEe: if ($id) { goto AC_al; } goto fYn1p; Smn6y: hAEVC: goto q3TwY; zrMrh: HjHtu: goto wKigT; h8HF4: $this->_callback("\x63\141\154\x6c\142\x61\143\153\x41\144\x64\x41\x66\164\145\x72", array($id, &$request_data)); goto VS5w8; nOpt3: if (!($pid > 0 && in_array("\154\145\166\x65\x6c", $this->fields))) { goto HjHtu; } goto OItb6; bivX1: $data = $this->_bulidData($request_data); goto G0qT5; m3Lr3: $udata = array("\x69\x64" => $id); goto JJHo7; q3TwY: } protected function postUpdate($id, $request_data) { goto D6eW7; mBada: $this->_removeFiles2($request_data["\x5f\x72\145\155\x6f\x76\x65\146\151\154\145\x73"]); goto auOdC; auOdC: $data = $this->_bulidData($request_data); goto H_63B; d1R_o: $pid = $data["\x70\151\144"]; goto bilCz; bilCz: if (!($pid > 0 && in_array("\x6c\145\166\x65\x6c", $this->fields))) { goto W7FWt; } goto RtwRG; awoY6: M2ZL4: goto uOskH; uOskH: VW__V: goto QgOB5; RtwRG: $data["\154\145\x76\145\154"] = $this->_getLevel($pid, $id); goto IYZHO; H_63B: $data["\x75\164\151\x6d\145"] = time(); goto d1R_o; PMKk8: $upload_path = $request_data["\x24\165\160\154\x6f\x61\x64\137\160\141\164\x68"]; goto mFvJh; RdOFH: $upload_name = $request_data["\44\x75\160\x6c\157\141\144\x5f\156\x61\x6d\x65"]; goto PMKk8; mFvJh: if (!($upload_name && $upload_path)) { goto VW__V; } goto RI0rv; nVm4p: xkex_: goto KPtdh; IYZHO: W7FWt: goto RdOFH; KPtdh: $this->_callback("\143\141\154\154\142\x61\143\x6b\x55\160\144\141\x74\145\101\x66\x74\145\162", array($id, &$request_data)); goto npv2g; aEvq6: N4bmP: goto rLmgd; tLG0o: $data[$upload_name] = $upload_path; goto awoY6; npv2g: $this->_log("\x75\160\144\141\x74\x65", array("\x74\151\x74\x6c\145" => $data["\164\x69\x74\154\x65"])); goto mw8T8; mT6z2: goto N4bmP; goto nVm4p; QgOB5: if ($this->db->update($this->table, $data, array("\x69\144", "\x3d", $id))->is()) { goto xkex_; } goto zF37i; eyGma: if (!in_array($upload_name, $this->fields)) { goto M2ZL4; } goto tLG0o; RI0rv: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto eyGma; zF37i: return $this->error("\xe4\xbf\x9d\345\255\230\xe5\xa4\xb1\350\264\xa5\xef\274\201"); goto mT6z2; D6eW7: $this->_callback("\143\141\x6c\x6c\142\x61\143\x6b\x55\160\x64\x61\164\145\x42\145\146\x6f\x72\145", array(&$request_data)); goto mBada; mw8T8: return $this->success("\345\xb7\xb2\xe4\xbf\x9d\xe5\xad\x98\xe6\x9b\264\346\x94\xb9\xef\xbc\x81"); goto aEvq6; rLmgd: } protected function postField($request_data) { goto nzs0L; lh4d_: goto r_hYh; goto Ru80w; nzs0L: $ids = $request_data["\x69\144"]; goto OhciA; w37o7: r_hYh: goto Mow_m; hIqHc: $value = $request_data["\166\x61\154\165\145"]; goto AoqJB; q3Y59: return $this->success(); goto w37o7; AoqJB: if ($this->db->update($this->table, array($name => $value), array("\151\x64", "\x49\x4e", $ids))->is()) { goto uO52T; } goto kqj9R; OhciA: $name = $request_data["\x6e\x61\x6d\145"]; goto hIqHc; kqj9R: return $this->error(); goto lh4d_; Ru80w: uO52T: goto q3Y59; Mow_m: } protected function postCount($request_data) { goto DsVWM; DsVWM: $table = $request_data["\x74\x61\142\x6c\x65"] ?: $this->table; goto QqEuu; QqEuu: $where = $request_data["\167\150\145\x72\x65"] ?: "\61\x20\x3d\x20\x31"; goto xS73k; xS73k: return $this->db->select($table)->where($where)->count(); goto GbL4s; GbL4s: } protected function postDelete($request_data) { goto p9f_f; vtYTZ: $this->_log("\162\x65\155\157\166\145", array("\x74\151\164\154\145" => count($ids))); goto R3y0O; A8cjL: $ids = $request_data["\x69\144"]; goto owXh0; kVSXJ: return $this->error("\xe6\x9c\211\40" . count($error) . "\346\235\xa1\xe6\225\xb0\346\215\256\xe5\x88\xa0\xe9\x99\xa4\xe5\244\261\350\xb4\245\xef\xbc\201"); goto Rej7f; Rej7f: goto HR8SX; goto tPjx7; p9f_f: $this->_callback("\x63\x61\x6c\x6c\x62\141\143\153\104\x65\154\x65\x74\145\x42\x65\x66\x6f\x72\x65", array(&$request_data)); goto YPHBb; LaUAb: $this->db->rollBack(); goto kVSXJ; sSAs7: if (count($error) === 0) { goto SkBXT; } goto LaUAb; bf7Us: hCLnl: goto sSAs7; owXh0: $this->db->beginTransaction(); goto JfCYH; MWf_R: $this->db->commit(); goto vtYTZ; R3y0O: return $this->success(); goto NCX_t; tPjx7: SkBXT: goto E3kNj; NCX_t: HR8SX: goto c02kD; JfCYH: foreach ($ids as $id) { goto UrURA; seKyC: MegOK: goto QRto1; brJZT: gkkzy: goto IAyHl; UrURA: $item = $this->db->select($this->table)->where(array("\151\144", "\75", $id))->get(); goto sqwgZ; IAyHl: $this->_trash($item, $request_data); goto seKyC; QRto1: a6O2j: goto hPo9L; ULV1S: $error[] = $id; goto QtXDj; sqwgZ: if ($this->db->delete($this->table, array("\x69\144", "\x3d", $id))->is()) { goto gkkzy; } goto ULV1S; Din8y: goto MegOK; goto brJZT; QtXDj: goto a6O2j; goto Din8y; hPo9L: } goto bf7Us; YPHBb: $error = array(); goto A8cjL; E3kNj: $this->_callback("\143\x61\154\x6c\x62\141\x63\x6b\x44\x65\x6c\145\x74\145\101\146\x74\x65\162", array(&$request_data)); goto MWf_R; c02kD: } }
